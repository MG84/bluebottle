{% load bb_ember %}
{% load i18n %}
{% load static %}

{% tplhandlebars "project" %}

    <div class="l-section detail" id="project-detail">
        <section class="l-wrapper">

            <figure class="project-image l-half">
                <img {{bindAttr src="image.large"}} width="100%" alt="Photo" />
            </figure>

            <div class="l-half">

                <article class="project-info">
                    <div class="project-meta">
                        {{#if country.name}}<span class="project-location"><span class="flaticon solid location-pin-1"></span> {{country.name}}</span>{{/if}}
                        {{#if theme.title}}<span class="project-theme"><span class="flaticon solid tag-2"></span> {{theme.title}}</span>{{/if}}
                    </div>
					{# no social icons in the project template #}
					{{!--}}
                    {{view App.SocialShareView}}
					{{--}}
                    <h1 class="project-title">{{title}}</h1>
                    <p class="project-description">{{pitch}}</p>
                </article>

            </div>
        </section>
	</div>
	
    <div class="l-section detail" id="project-members">
        <section class="l-wrapper">
		
	    <ul class="member-list">
	        <li class="member-initiator">
	            <ul>
	                <li>
	                    <a {{action 'openInBigBox' 'userModal' owner }} class="member">
	                        <figure class="member-avatar"><img {{bindAttr src="owner.getAvatar"}} /></figure>
	                        <h4>{% trans "Initiator" %}</h4>
	                        <strong class="member-name">{{owner.full_name}}</strong>
	                        <em class="member-organisation">{{organization}}</em>
	                    </a>
	                </li>
	            </ul>
	        </li>
		</ul>
		
		{{!--}}
        <div class="member-initiator">
            <a {{action 'openInBigBox' 'userModal' owner }} class="member">
                <figure class="member-avatar"><img {{bindAttr src="owner.getAvatar"}} /></figure>
                <h4>{% trans "Initiator" %}</h4>
                <strong class="member-name">{{owner.full_name}}</strong>
                <em class="member-organisation">{{organization}}</em>
            </a>
		</div>
		{{--}}
		
		{{!--}}
	    <ul class="member-list">
	        <li class="member-initiator">
	            <ul>
	                <li>
	                    <a {{action 'openInBigBox' 'userModal' owner }} class="member">
	                        <figure class="member-avatar"><img {{bindAttr src="owner.getAvatar"}} /></figure>
	                        <h4>{% trans "Initiator" %}</h4>
	                        <strong class="member-name">{{owner.full_name}}</strong>
	                        <em class="member-organisation">{{organization}}</em>
	                    </a>
	                </li>
	            </ul>
	        </li>
		</ul>
		{{--}}
		
		{# task list view #}
		<ul class="task-list">
			{{#each tasks}}
				<li class="task">
					<div class="task-status">
						{{#if owner}}
							<span class="task-status-label">{{status}}</span>
							<figure class="member-avatar">
								<img {{bindAttr src="owner.getAvatar"}} />
							</figure>
						{{else}}
							<span class="task-status-label">{{status}} task</span>
							<span class="flaticon solid work-1"></span>
						{{/if}}
					</div>
					
					<div class="task-content">
						<strong class="task-name">{{name}}</strong>
						<span class="task-expoertise">{{expertise}}</span>
					
						<span class="task-time-needed flaticon stroke time-1">{{timeNeeded}}</span>
						<span class="task-deadline flaticon stroke calendar-2">{{deadline}}</span>
					</div>
				</li>
			{{/each}}
		</ul>
		
        {% if 'fund' in bb_apps %}
        {% block_verbatim 'project-funding' %}
            {{#if isFundable}}
                <section class="l-wrapper">
                    <div class="project-status">

                        {{#if campaign.deadline}}
                            {{#if isCampaign}}
                            <div class="project-days-left">
                                <strong><span class="flaticon solid stopwatch-1"></span> {{campaign.daysToGo}} <em>{% trans "days to go" %}!</em></strong>
                            </div>
                            {{else}}
                            <div class="project-days-left">
                                <strong><span class="flaticon solid clock-1"></span> {{campaign.daysToGo}} <em>{% trans "days to go" %}</em></strong>
                            </div>
                            {{/if}}
                        {{/if}}

                        <div class="project-fund">
                            <p class="project-fund-amount">
                                <strong class="amount-donated">&euro;{{localize campaign.money_donated}}</strong>
                                {% trans "of" %}
                                <strong class="amount-asked">&euro;{{localize campaign.money_asked}}</strong>
                                {% trans "raised" %}
                            </p>

                            <div class="project-fund-amount-slider">
                                <strong style="width: 0%;" class="slider-progress is-in-progress">
                                    <em class="slider-percentage">0%</em>
                                </strong>
                            </div>
                        </div>

                        <div class="project-action">
                            <a href='#' {{ action 'addDonation' this }} class="btn btn-primary btn-iconed"><span class="flaticon solid wallet-1"></span> {% trans "Support project" %}</a>
                        </div>
                    </div>
                </section>
            {{else}}
                <section class="l-wrapper">
                    <div class="project-status">

                        <div class="project-days-left l-one-third">
                        {% comment %}
                            <strong><span class="flaticon solid clock-1"></span>[DATE COMPLETED]</strong>
                            <em>{% trans "completed" %}</em>
                        {% endcomment %}
                        </div>

                        {{#if campaign}}
                            <div class="project-fund l-one-third">
                                <p class="project-fund-amount">
                                    <strong class="amount-donated">&euro;{{localize campaign.money_donated}}</strong>
                                    {% trans "raised" %}
                                </p>

                                <div class="project-fund-amount-slider"><strong style="width: 0%;" class="slider-progress is-in-progress"><em class="slider-percentage">0%</em></strong></div>
                            </div>
                        {{/if}}
                    </div>
                </section>
            {{/if}}
            {% endblock_verbatim %}
        {% endif %}
    </div>
	
	{{!--}}
    <div class="l-section" id="project-members">
        <section class="l-wrapper">
            {{view App.ProjectMembersView}}
        </section>
    </div>
	{{--}}

    <nav class="l-section" id="project-actions">
        <div class="l-wrapper">

            <ul class="tabs four">
                {% if 'wallposts' in bb_apps %}
                {% block_verbatim 'project_wallpost_tab' %}
                    <li class="tab-updates">
                        {{#link-to 'project.index'}}
                            <span class="tab-icon amount">{{controllers.projectIndex.meta.total}}</span>
                            <strong class="tab-title">
                                {% trans "Updates" %}

                                {{#if controllers.projectIndex.meta.total}}
                                    {{#if controllers.projectIndex.firstObject.isLoaded}}
                                        <em class="tab-subtitle">{{localize controllers.projectIndex.firstObject.created formatting="X"}}</em>
                                    {{else}}
                                        <em class="tab-subtitle">{% trans "Loading&#8230;" %}</em>
                                    {{/if}}
                                {{else}}
                                    <em class="tab-subtitle">{% trans "No updates" %}</em>
                                {{/if}}
                            </strong>
                        {{/link-to}}
                    </li>
                {% endblock_verbatim %}
                {% endif %}
                {% if 'tasks' in bb_apps %}
                {% block_verbatim 'project_task_tab' %}
                    <li class="tab-tasks">
                        {{#if taskCount}}
                            {{#link-to 'projectTasks'}}
                                <span class="tab-icon">{{taskCount}}</span>
                                <strong class="tab-title">Tasks <em class="tab-subtitle">{% trans "Skills needed" %}</em></strong>
                            {{/link-to}}
                        {{else}}
                            {{#link-to 'projectTasks'}}
                                <span class="tab-icon">0</span>
                                <strong class="tab-title">Tasks <em class="tab-subtitle">{% trans "No skills needed" %}</em></strong>
                            {{/link-to}}
                        {{/if}}
                    </li>
                {% endblock_verbatim %}
                {% endif %}
                <li class="tab-plan">
                    {{#link-to "projectPlan"}}
                        <span class="tab-icon"><span class="flaticon solid document-2"></span></span>
                        <strong class="tab-title">Project Plan <em class="tab-subtitle">{% trans "Read full plan" %}</em></strong>
                    {{/link-to}}
                </li>
            </ul>

        </div>
    </nav>

    {{ outlet }}

{% endtplhandlebars %}